<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WOD Generator | COACH CHRIS</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    
    <style>
        /* Configure Tailwind to use the Inter font and set black background */
        html {
            font-family: 'Inter', sans-serif;
        }
        body {
            background-color: #000;
            color: #fff;
        }
        /* Custom styles for the high-contrast buttons */
        .btn-primary-white {
            background-color: white;
            color: black;
            box-shadow: 0 4px 15px 0 rgba(255, 255, 255, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-primary-white:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px 0 rgba(255, 255, 255, 0.4);
        }
        .btn-primary-white:disabled {
            background-color: #f1f1f1;
            color: #737373;
            cursor: not-allowed;
        }
        /* Style for the pre-formatted WOD text area */
        #wod-output pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            min-height: 80px; /* Ensure visual space even when empty */
        }
        /* Style for the custom logo text structure */
        .logo-text {
            line-height: 1.1;
            text-align: center;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 antialiased">

    <div id="app-container" class="w-full max-w-md bg-black rounded-xl p-6 md:p-8 space-y-8 border-2 border-white shadow-2xl">

        <!-- Branded Header -->
        <header class="logo-text text-white/90">
            <h1 class="font-black tracking-wider leading-none">
                <div class="text-3xl sm:text-4xl tracking-[.3em]">COACH CHRIS</div>
                <div class="text-xs tracking-tight text-white/80 mt-[-4px] leading-none">CIRCULAR ROOTS COACHING</div>
                <div class="text-[10px] tracking-tighter text-white/60 leading-none">TRAIN UNCNVNTNL</div>
            </h1>
        </header>

        <!-- WOD Output Card (High Contrast - White on Black background) -->
        <div id="wod-card" class="bg-white text-black p-5 rounded-xl border border-black shadow-xl transition-opacity duration-500 opacity-0">
            <h2 class="text-2xl font-extrabold text-black mb-3 pb-2 border-b border-black/20 flex items-center justify-between">
                WOD <span class="text-base text-black/70 font-semibold tracking-wide"> (Workout of the Day)</span>
                <!-- Single spinner for the whole process -->
                <svg id="loading-spinner" class="animate-spin h-6 w-6 text-black/70 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </h2>

            <!-- Workout Content -->
            <div id="wod-output" class="text-black space-y-4">
                <div id="wod-format-name" class="text-lg font-extrabold uppercase"></div>
                <div id="wod-format-desc" class="text-sm italic text-black/70"></div>
                <pre id="wod-movements" class="text-base leading-relaxed bg-black/5 p-4 rounded-lg border border-dashed border-black/30"></pre>
                <div id="wod-time-cap" class="text-sm font-bold text-black/80 border-t pt-3 border-black/10"></div>
            </div>

            <hr class="my-4 border-black/10">
            
            <!-- Copy and Share Button Group -->
            <div class="flex space-x-2">
                <button id="copy-button" class="bg-black text-white hover:bg-gray-800 font-semibold py-2 w-1/2 rounded-lg text-sm transition duration-150">
                    Copy WOD
                </button>
                <button id="share-button" class="bg-black text-white hover:bg-gray-800 font-semibold py-2 w-1/2 rounded-lg text-sm transition duration-150">
                    Share WOD
                </button>
            </div>

        </div>

        <!-- Generate Button (White background, Black text - Strong CTA style) -->
        <button id="generate-button" class="btn-primary-white w-full font-bold py-4 uppercase rounded-xl tracking-wider focus:outline-none focus:ring-4 focus:ring-white focus:ring-opacity-50">
            GENERATE NEW WOD
        </button>

        <!-- DISCLAIMER SECTION -->
        <p class="text-[10px] text-white/40 text-center pt-2">
            **Disclaimer:** Consult with a physician before starting any exercise program. All workouts are performed at your own risk. Listen to your body and modify as needed.
        </p>

        <!-- COPYRIGHT SECTION (Now dynamically updated) -->
        <p class="text-[10px] text-white/30 text-center pt-1">
            Copyright &copy; <span id="current-year"></span> COACH CHRIS | CIRCULAR ROOTS COACHING | TRAIN UNCNVNTNL. All rights reserved.
        </p>
        <!-- NEW MOTIVATIONAL LINE -->
        <p class="text-[9px] text-white/30 text-center mt-[-4px]">
            FITTER STRONGER BETTER
        </p>

    </div>

    <script type="module">
        // ===================================
        // 1. DOM Elements
        // ===================================
        const generateButton = document.getElementById('generate-button');
        const copyButton = document.getElementById('copy-button');
        const shareButton = document.getElementById('share-button'); // New element
        const wodCard = document.getElementById('wod-card');
        const wodFormatName = document.getElementById('wod-format-name');
        const wodFormatDesc = document.getElementById('wod-format-desc');
        const wodMovements = document.getElementById('wod-movements');
        const wodTimeCap = document.getElementById('wod-time-cap');
        const loadingSpinner = document.getElementById('loading-spinner');
        const currentYearSpan = document.getElementById('current-year');

        // ===================================
        // 2. WOD Data Definitions
        // ===================================
        const formats = [
            // AMRAP/EMOM generate times between 10 and 30 minutes (always even numbers)
            { name: "AMRAP", description: "As Many Rounds/Reps As Possible in the time cap (10-30 min focus).", 
              generator: () => `TIME CAP: ${Math.floor(Math.random() * 11) * 2 + 10} MINUTES` }, 
            { name: "FOR TIME", description: "Complete the following work as quickly as possible (typically 15-25 min).", 
              generator: () => `ROUNDS: ${Math.floor(Math.random() * 3) + 3} ROUNDS FOR TIME` }, // 3, 4, or 5 rounds
            { name: "EMOM", description: "Every Minute On the Minute. Perform the work at the start of each minute (10-30 min focus).", 
              generator: () => `TOTAL TIME: ${Math.floor(Math.random() * 11) * 2 + 10} MINUTES` }, 
            { name: "CHIPPER", description: "A high-volume workout. Complete all reps of one movement before moving to the next (time cap recommended).", 
              generator: () => "ONE TIME THROUGH FOR TIME (HIGH VOLUME)" },
        ];

        // Movements categorized by body part to guarantee a Full Body workout
        const movements = {
            lower: [ // Squats, Lunges, Hinge
                "Air Squats", "Lunges", "Kettlebell Goblet Squats", "Kettlebell Swings (American)"
            ],
            upper: [ // Push and Press
                "Push-ups", "Hand-release Push-ups", "Kettlebell Press (Each Arm)"
            ],
            core_cardio: [ // Midline stability, cardio, or complex movements (Cleans/Snatches act as full body/cardio)
                "Burpees", "Sit-ups", "Run (400m)", "Kettlebell Snatches (Each Arm)", "Kettlebell Cleans (Each Arm)"
            ],
        };

        // ===================================
        // 3. Utility Functions
        // ===================================
        function selectRandom(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        /**
         * Compiles the WOD content into a single, clean text string.
         * @returns {string} The formatted WOD text.
         */
        function compileWODText() {
            const formatName = wodFormatName.textContent;
            const formatDesc = wodFormatDesc.textContent.replace(/[()]/g, ''); // Remove parentheses for clean text
            const movements = wodMovements.textContent;
            const timeCap = wodTimeCap.textContent;

            return `WOD: ${formatName}\n${formatDesc}\n\n${movements}\n\n${timeCap}\n\n--- Coach Chris | TRAIN UNCNVNTNL ---`;
        }

        /**
         * Shows visual success feedback on the given button.
         * @param {HTMLElement} button - The button element to modify.
         * @param {string} successText - The text to display on success.
         * @param {string} originalText - The text to revert to.
         */
        function showActionSuccess(button, successText, originalText) {
            button.textContent = successText;
            button.classList.add('bg-green-600', 'hover:bg-green-600');
            button.classList.remove('bg-black', 'hover:bg-gray-800');

            setTimeout(() => {
                button.textContent = originalText;
                button.classList.remove('bg-green-600', 'hover:bg-green-600');
                button.classList.add('bg-black', 'hover:bg-gray-800');
            }, 1500);
        }

        // ===================================
        // 4. Action Logic
        // ===================================

        /**
         * Copies the generated WOD text to the clipboard.
         */
        function copyWODToClipboard() {
            const wodText = compileWODText();

            // Create a temporary, invisible textarea to hold the text for copying
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = wodText;
            tempTextArea.style.position = 'absolute';
            tempTextArea.style.left = '-9999px'; 
            document.body.appendChild(tempTextArea);
            tempTextArea.select();

            try {
                // Use document.execCommand('copy') for maximum compatibility
                const successful = document.execCommand('copy');
                if (successful) {
                    showActionSuccess(copyButton, 'Copied!', 'Copy WOD');
                } else {
                    showActionSuccess(copyButton, 'Copy Failed', 'Copy WOD');
                }
            } catch (err) {
                console.error('Copy failed:', err);
                showActionSuccess(copyButton, 'Copy Failed', 'Copy WOD');
            } finally {
                // Clean up the temporary element
                document.body.removeChild(tempTextArea);
            }
        }

        /**
         * Shares the generated WOD using the Web Share API or falls back to copying.
         */
        async function shareWOD() {
            const wodText = compileWODText();
            const shareTitle = "New WOD Challenge from COACH CHRIS";

            if (navigator.share) {
                try {
                    await navigator.share({
                        title: shareTitle,
                        text: wodText
                        // URL is often required, but omitted here as we're sharing pure text content
                    });
                    // Note: No success feedback needed as the native UI handles it.
                } catch (error) {
                    // This error usually happens if the user cancels or the environment is restricted.
                    if (error.name !== 'AbortError') {
                        // Fallback to copy if sharing fails critically
                        copyWODToClipboard();
                        showActionSuccess(shareButton, 'Copied! (Share Unavailable)', 'Share WOD');
                    }
                }
            } else {
                // Fallback for browsers that don't support the Web Share API
                copyWODToClipboard();
                showActionSuccess(shareButton, 'Copied! (Share Unavailable)', 'Share WOD');
            }
        }


        // ===================================
        // 5. WOD Generation Logic
        // ===================================

        /**
         * Generates a list of movements, GUARANTEEING one from Lower, one from Upper, and one from Core/Cardio.
         */
        function generateMovements(formatName) {
            let movementList = [];
            // Always use all three categories for full-body guarantee
            const selectedCategories = ['lower', 'upper', 'core_cardio']; 
            let allSelectedMoves = []; 

            for (const category of selectedCategories) {
                // Filter out moves already selected 
                let availableInCat = movements[category].filter(move => !allSelectedMoves.includes(move));
                if (availableInCat.length === 0) continue; 

                const move = selectRandom(availableInCat);
                allSelectedMoves.push(move);

                // --- Reps/Distance Assignment Logic ---
                let repCount;
                let movementName = move.split('(')[0].trim(); 
                
                if (move.includes("Run")) {
                    const preset = move.match(/\((.*?)\)/)[1]; 
                    movementList.push(`- ${preset.toUpperCase()} OF ${movementName.toUpperCase()}`);
                } else if (formatName === "EMOM") {
                    // Lower rep count for EMOM (5 to 10 reps)
                    repCount = Math.floor(Math.random() * 6) + 5; 
                    movementList.push(`- ${repCount} ${movementName.toUpperCase()}`);
                } else if (movementName === "Burpees" || movementName.includes("Clean") || movementName.includes("Snatch")) {
                    // Medium rep count for high-intensity or complex movements (8, 10, 12, 15)
                    repCount = selectRandom([8, 10, 12, 15]);
                    if (move.includes("(Each Arm)")) {
                         movementList.push(`- ${repCount} REPS PER ARM OF ${movementName.toUpperCase()}`);
                    } else {
                        movementList.push(`- ${repCount} ${movementName.toUpperCase()}`);
                    }
                } else {
                    // Standard reps for gymnastics/squats/swings (15, 20, 25, 30)
                    repCount = selectRandom([15, 20, 25, 30]);
                    movementList.push(`- ${repCount} ${movementName.toUpperCase()}`);
                }
            }

            // Shuffle the final list of movements to mix the display order
            movementList.sort(() => Math.random() - 0.5);

            return movementList.join('\n');
        }

        /**
         * Generates and displays the WOD structure (format, movements, time cap).
         */
        function generateWODStructure() {
            // 1. Generate Workout Structure
            const selectedFormat = selectRandom(formats);
            const movementsText = generateMovements(selectedFormat.name);

            wodFormatName.textContent = selectedFormat.name;
            wodFormatDesc.textContent = selectedFormat.description;
            wodMovements.textContent = movementsText;
            
            const formatDetail = selectedFormat.generator();
            wodTimeCap.textContent = formatDetail;
        }

        /**
         * Main function to control the UI state and generate the WOD.
         */
        function generateFullWOD() {
            // 1. Set UI State: Loading (start)
            generateButton.disabled = true;
            generateButton.textContent = "GENERATING... STAND BY";
            loadingSpinner.classList.remove('hidden');
            wodCard.classList.add('opacity-50');

            // Use a slight delay to simulate processing, improving user experience
            setTimeout(() => {
                try {
                    // 2. Generate and display the FAST, local workout structure
                    generateWODStructure();
                    
                    // 3. Update UI to show success
                    wodCard.classList.remove('opacity-0'); 

                } catch (error) {
                    console.error("A critical error occurred during WOD generation:", error);
                    // Fail state for the UI
                    wodFormatName.textContent = "FATAL ERROR";
                    wodFormatDesc.textContent = "A critical error occurred. Please refresh or try again.";
                    wodMovements.textContent = "LOCAL GENERATION FAILED.";
                    wodTimeCap.textContent = "STATUS: ABORTED";
                } finally {
                    // 4. Set UI State: Ready (end)
                    loadingSpinner.classList.add('hidden');
                    generateButton.textContent = "GENERATE NEW WOD";
                    generateButton.disabled = false;
                    wodCard.classList.remove('opacity-50');
                }
            }, 100); 
        }
        
        // ===================================
        // 6. Initialization
        // ===================================
        function initializeApp() {
             // Set the current year for the copyright notice
            if (currentYearSpan) {
                currentYearSpan.textContent = new Date().getFullYear();
            }
            
            generateButton.addEventListener('click', generateFullWOD);
            copyButton.addEventListener('click', copyWODToClipboard);
            shareButton.addEventListener('click', shareWOD); // Bind share function
            
            // Run on load to populate the initial card immediately
            generateFullWOD(); 
        }

        // Initialize the app once the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', initializeApp);

    </script>
</body>
</html>

